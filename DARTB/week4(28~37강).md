# 과제 - 전주현

<aside>
✅ 문제까지 풀려니까 생각보다 빡세네요 정규세션 과제 때  템플릿을 미리 만들어놓으면 좋을듯해용

</aside>

### 28강.  필터

- 필터를 실행하는 순서: 추출 - 데이터원본 - 컨텍스트 - 차원 - 측정값 - 필터 순으로 동작
- 추출을 다른 이름으로 저장: 이 저장주소에 있는 로컬 데이터와만 연동해서 작업할수 있도록
- 컨텍스트 필터: 를 사용하면 다른 필터가 컨텍스트 필터에 종속되어 작동함 (컨텍스트 필터가 다른 필터보다 상위 필터라서)
    - ex. 상위 매출 10개인 제품명만 필터링 하기
    - 제품 이름 필드를 필터 창에 드래그한다.
    - 범주 필드도 필터 창에 드래그하면 데이터가 왜곡 → 범주:기술 필드를 ‘컨텍스트에 추가’하면 범주필터가 우선적으로 작용하고 매출 필드가 종속적으로 적용됨
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled.png)
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%201.png)
    

### 29강. 그룹

- 그룹을 이용해 수동으로 필드를 묶을 수 있으며 기존 데이터 원본에 없는 사용자 지정 그룹 필드 만들기 가능
- 제품이름(열), 수익(행)에 드래그하면 각 회사의 제품들이 얼마나 많은 수익을 냈는지 그래프로 보여줌 → 각 회사별로 그룹핑 하자.
- 뷰(시트 제일 큰 화면)에서 그룹핑 가능 (드래그해서)
- 제품 이름 필드에 들어가서 마우스 우클릭 → 만들기 → 그룹 으로 수동 필드 묶기 가능 → 그룹 다 만들고 제품이름(그룹)을 마크카드의 색상에 드래그하면 그래프 색깔로 구분가능
- 

 

### 30강. 계층

- 태블로는 날짜 데이터와 함께 제공되는 경우에 자동으로 계층을 생성함
- 위치 필드는 지역 - 국가/지역 - 시/도 - 도시 순으로 계층이 있음
- 두개의 필드를 동시에 잡고 우클릭 → 계층 → 계층 만들기
- 계층화된 위치필드를 선반에 드래그 → 왼쪽 +버튼 누르면 계층에 따라 정렬

### 31강. 집합

- 사용자가 특정조건을 설정하여 데이터들을 구분
    - 수익을 많이 낸 상위10개 도시 표현
- 시/도 필드 → 우클릭 → 만들기 → 집합

### 32강. 결합집합

- 집합에서 두 가지의 조건을 적용하고 싶을때는 어떻게 해야할까?
- 매출이 5만원 이상이고 수익률이 10%이상인 도시들
    - 매출 필드를 텍스트 마크창에, 매출5만원이상인 집합을 색상 마크창에
    - 수익률 필드를 텍스트 마크창에, 수익률10%이상인 집합을 색상 마크창에
    - 그 후 집합된 필드를 우클릭 → 결합집합 만들기

### 33강. 계산된 필드

- 방법
    - 1, 데이터 패널을 통해 생성
    - 2, 분석 탭 → 계산된 필드 만들기
    - 3, 사용하고자 하는 필드에 마우스 우클릭
- 제품별로 얼마나 수익ㅇㄹ 냈는지 백분율로 나타내기
- 

![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%202.png)

### 34강. 행수준계산

- 종류: 기본 계산, 테이블 계산, LOD 표현식
- 행수준계산 / 집계계산
- 고객이름을 성과 이름으로 분리
    - 순서상 이름이 먼저와서 토큰 번호 1, 성을 분리하고 싶으면 토큰 번호 2 입력하면됨
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%203.png)
    
- 수익성이 있는 제품들에 어떤 것이 있는지?
    - IF THEN 함수 사용
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%204.png)
    
- 주문한 날짜로부터 주문이 배송된 날까지, 두 날짜 사이의 일수 찾기
    - DATEDIFF 함수
    - 측정값 → 차원값으로 변경 필요 (주문 아이디가 여러개의 레코드를 가진 경우 일수를 전부 합산해버리기 때문이다)
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%205.png)
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%206.png)
    

### 35강. 집계계산

- 매출 → 우클릭 → 기본 속성 → 집계
- 계산된 필드 → 오른쪽 창 → 집계함수
- 합계 매출 집계 계산 만들어보기
    - 
- 연도별 주문건수 보기
    - 
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%207.png)
    

### 36강. 테이블계산

- 뷰에 보이는 내용을 바탕으로 데이터가 계산되는 것이 테이블 계산
- 월마다, 연도마다 누적매출을 만드려면
    - 계산된 필드 만들기 → 테이블 계산 → 계산 공간에 RUNNING_SUM(SUM([매출]))을 입력
    - 
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%208.png)
    
- 현재 달과 전 월의 차이 찾기
    - 
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%209.png)
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2010.png)
    

### 37강. 퀵테이블계산

- 사용하고자 하는 필드 위에 마우스 우클릭 → 퀵 테이블 계산
- 누계 : 집계한 값을 한번 더 집계하는 것
    - 분기별 누적 매출 & 월별 매출 차트
        - 마우스 우클릭 한채로 열선반에 끌어다놓기
        - 행선반에 매출 드래그
        - 이중축을 이용해 누적매출&월별매출 다 볼거기 때문에 Ctrl 누른 상태로 옆으로 이동시켜 복제
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2011.png)
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2012.png)
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2013.png)
        
- 차이: 각 제품에 대한 연도별 매출 차이 알아보기
    
    ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2014.png)
    
    - 비율 차이: 측정값들 사이의 성장률 또는 % 차이
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2015.png)
        
- 지역별 제품 매출 순위와 구성비율 만들기
    - 구성비율: 전체에서 각 항목들의 비중 확인
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2016.png)
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2017.png)
        
    - 구성비율
        - 패널(아래로) 선택하면 고정비율합이 백퍼센트 기준으로 맞춰짐
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2018.png)
        
        ![Untitled](%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6%20-%20%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%AE%E1%84%92%E1%85%A7%E1%86%AB%208d56b0451edb413d99d2d74be2140e15/Untitled%2019.png)
        
    - 
- 백분위수
    - 매출이 많은 고객과 적은 고객을 보고자 할 때

## 문제1

- 문제: 유정이는 superstore 데이터셋에서 '주문' 테이블을 보고 있습니다. 국가/지역 - 시/도- 도시 의 계층을 생성했습니다. 계층 이름은 '위치'로 설정하겠습니다.
    1. 날짜의 데이터 타입을 '날짜'로 바꾸었습니다.ㅜ코로나 시기의 도시별 매출 top10을 확인하고자 배송 날짜가 코로나시기인 2021년, 2022년에 해당하는 데이터를 필터링했고 위치 계층을 행으로 설정해 펼쳐두었습니다. 이때, 수익의 합계가 TOP 10인 도시들만을 보았습니다. 겉보기에는 전체 10개로, 잘 나온 결과처럼 보입니다. 그러나 유정이는 치명적인 실수를 저질렀습니다. 오늘 배운 '컨텍스트 필터'의 내용을 고려하여 올바른 풀이 및 결과를 구해주세요.
- 문제 답변: 컨텍스트 필터를 적용 안해서 년(배송날짜) 필터와 도시 필터가 독립적으로 작용한다. 이렇게되면 모든 연도에 대해서 도시 필터링을 하게 되는데, 2021년, 2022년 데이터에 대해서 상위 10개 추출임!

## 문제2

- 문제
    
    ```
    지금 데이터셋의 측정값에는 매출, 수량, 수익, 할인율이 있습니다. 경영 시각화에 추가로 많이 사용되는 변수를 몇 개 더 만들어보겠습니다.
    
    1) 연간 매출 성장률(Year-over-Year Growth)를 만들어주세요.
    
    Hint: 매출 - 작년 매출 / 작년 매출(절댓값) 입니다. LOOKUP 함수를 사용해주세요.
    
    2) 주문당 평균 이익(Average Profit per Order)를 만들어주세요.
    
    3) 총 매출 대비 이익률 (Profit Margin)을 만들어주세요.
    
    4) 배송 지연일(Delivery Delay Days)을 만들어주세요.
    
    5) 또 필요하다고 생각되는 다른 매개변수를 구상해보세요.
    ```
    
- 답
    - 1) 연간 매출 성장률:
    
    ```sql
    ( SUM([매출])  -  LOOKUP(SUM([매출] , -1) ) / ABS(LOOKUP(SUM([매출] , -1))
    ```
    
    - 2) 주문당 평균 이익:
        - 고유주문건수를 구하기 위해 COUNTD사용
    
    ```sql
    SUM([이익]) / COUNTD([주문ID])
    ```
    
    - 3) 총 매출 대비 이익률 :
    
    ```sql
    SUM([이익]) / SUM([매출])
    ```
    
    - 4) 배송 지연일:
    
    ```sql
    DATEDIFF(’day’, [주문날짜], [배송날짜])
    ```
    
    - 5)

### 문제3

- 문제
    - 
    
    ```
    가장 많이 주문한 사람들은 물건 배송을 빨리 받았을까요?
    1) 국가/지역별(이하 '나라'로 통칭), 범주별로 배송일자가 다를 수 있으니 먼저, 나라별/범주별로 평균 배송일자를 설정한 뒤,
    2) 각 나라에서 가장 많이 주문한 사람의 이름을 첫 번째 열,
    3) 그 사람이 주문한 제품 이름을 2번째 열,
    4) 각 상품이 배송까지 걸린 날 수를 표현하고
    5) 그리고 만약 배송이 각 나라/범주별 평균보다 빨랐다면 '빠름', 같다면 '평균', 느리다면 '느림' 으로 print 해주세요.
    ```
    
- 답
    1. 배송까지 걸린 일수 계산: 
    
    ```sql
    **DATEDIFF**(’day’, [배송 날짜], [주문 날짜])
    ```
    
    1. 나라별/범주별 평균 배송일자 설정: 
    
    ```sql
    FIXED [국가/지역],[범주]: **AVG**([배송까지 걸린 일수])
    ```
    
    1. 고객별로 주문 수 세기: 
    
    ```sql
    FIXED [국가/지역], [고객ID] : **COUNT**([주문ID])
    ```
    
    1. 각 나라에서 가장 많이 주문한 사람 횟수 찾기: 
    
    ```sql
    FIXED [국가/지역]: **MAX**([고객별 주문 횟수])
    ```
    
    1. 각 나라에서 가장많이 주문한 사람의 이름 찾기:
    
    ```sql
     **IF** [고객별 주문 횟수] = [국가별 한 고객 최다 주문 횟수] **THEN** [고객이름] **END**  
    ```
    
    1. 배송이 각나라/범주별 평균보다 빠른지 (빠름,평균,느림)으로 출력: 
    
    ```sql
    IF [배송까지 걸린 일수] < [나라/범주별 평균 배송일수] THEN “빠름”, 
    ELSEIF [배송까지 걸린 일수] = [나라범주별 평균 배송일수] THEN “평균”, 
    ELSE "느림" END
    ```
    

### 문제4

- 문제
    - 34강 참고
    
    ```
    ![image-2.png](https://github.com/yousrchive/tableau/blob/main/study/img/1st%20study/image-13.png?raw=true)
    주문ID별로 주문 처리에 걸리는 시간(DATEDIFF 함수를 사용하여 주문 날짜와 배송 날짜의 차를 구함)을 표시하였습니다.
    
    이때, 2번째 행에서는 11월 26일 ~ 11월 30일까지 4일이 걸렸음에도 불구, 주문 처리일은 12일로 뜹니다.
    왜 이런 일이 발생하는 것이며, 이 경우 어떻게 처리할 수 있을까요?
    ```
    
- 답
    - 측정값 → 차원값으로 변경 필요 (주문 아이디가 여러개의 레코드row를 가진 경우 일수를 전부 합산해버리기 때문이다)

### 문제5
